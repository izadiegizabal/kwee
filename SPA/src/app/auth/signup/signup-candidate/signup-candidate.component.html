<mat-horizontal-stepper #stepper linear="true">
  <mat-step [stepControl]="firstFormGroup">
    <form [formGroup]="firstFormGroup">
      <ng-template matStepLabel>Choose sign up method</ng-template>
      <h2>Choose your favourite method to sign up!</h2>
      <div class="container"
           fxLayout="column"
           fxLayoutAlign="center center"
           fxLayoutGap="8px">
        <div class="signupButton">
          <button mat-raised-button matStepperNext>
            <mat-icon class="svg" color="accent" svgIcon="email"></mat-icon>
            <span>Continue with email</span>
          </button>
        </div>
        <div class="signupButton">
          <button color="primary" mat-raised-button matStepperNext>
            <mat-icon fontIcon="fa-github" fontSet="fab"></mat-icon>
            <span>Continue with GitHub</span>
          </button>
        </div>
        <div class="signupButton">
          <button color="primary" id="linkedinBtn" mat-raised-button matStepperNext>
            <mat-icon fontIcon="fa-linkedin-in" fontSet="fab"></mat-icon>
            <span>Continue with LinkedIn</span>
          </button>
        </div>
        <div class="signupButton">
          <button color="primary" id="googleBtn" mat-raised-button matStepperNext>
            <mat-icon fontIcon="fa-google" fontSet="fab"></mat-icon>
            <span>Continue with Google</span>
          </button>
        </div>
        <div class="signupButton">
          <button color="primary" id="twitterBtn" mat-raised-button matStepperNext>
            <mat-icon fontIcon="fa-twitter" fontSet="fab"></mat-icon>
            <span>Continue with Twitter</span>
          </button>
        </div>
      </div>
    </form>
  </mat-step>
  <mat-step [stepControl]="secondFormGroup">
    <form [formGroup]="secondFormGroup">
      <ng-template matStepLabel>Fill in your info</ng-template>
      <div class="container"
           fxFlex="100%"
           fxFlex.gt-md="60%"
           fxFlexOffset="15%"
           fxFlexOffset.xs="0"
           fxLayout="column"
           fxLayoutAlign="center"
           fxLayoutGap="8px">
        <div fxLayout="row"><h2>Fill in the information below to be set to go!</h2></div>
        <div class="line1" fxLayout="column">
          <mat-form-field>
            <input formControlName="name" matInput placeholder="Full name" required>
            <mat-icon color="primary" matPrefix svgIcon="person"></mat-icon>
            <mat-error *ngIf="!secondFormGroup.get('name').valid ">
              This field is required
            </mat-error>
          </mat-form-field>
        </div>
        <br>
        <div fxLayout="row" fxLayout.xs="column" fxLayoutGap="16px" fxLayoutGap.xs="0">
          <mat-form-field>
            <input formControlName="email" matInput placeholder="Email" required>
            <mat-icon color="primary" matPrefix svgIcon="email"></mat-icon>
            <mat-error *ngIf="!secondFormGroup.get('email').valid ">
              Please enter a valid email
            </mat-error>
          </mat-form-field>
          <mat-form-field>
            <input formControlName="confEmail" matInput placeholder="Confirm Email" required>
            <mat-error *ngIf="!secondFormGroup.get('confEmail').valid ">
              Emails do not match
            </mat-error>
          </mat-form-field>
        </div>
        <br>
        <div fxLayout="row" fxLayout.xs="column" fxLayoutGap="16px" fxLayoutGap.xs="0">
          <mat-form-field>
            <mat-icon color="primary" matPrefix svgIcon="lock"></mat-icon>
            <input [type]="hide ? 'text' : 'password'" formControlName="password" matInput placeholder="Password"
                   required>
            <mat-error *ngIf="!secondFormGroup.get('password').valid ">
              Password must be 6 characters or more
            </mat-error>
          </mat-form-field>
          <mat-form-field>
            <input [type]="hide ? 'text' : 'password'" formControlName="password2" matInput
                   placeholder="Confirm Password" required>
            <mat-icon (click)="hide = !hide" [svgIcon]="hide ? 'visibility' : 'visibility-off'" color="primary"
                      matSuffix></mat-icon>
            <mat-error *ngIf="!secondFormGroup.get('password2').valid">
              Passwords do not match
            </mat-error>
          </mat-form-field>
        </div>
        <br>
        <div fxLayout="row" fxLayout.xs="column">
          <mat-form-field>
            <input [matDatepicker]="picker" formControlName="birthday" matInput placeholder="Birthday" required>
            <mat-datepicker-toggle [for]="picker" matPrefix></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
            <mat-error *ngIf="secondFormGroup.get('birthday').errors?.required ">
              This field is required
            </mat-error>
            <mat-error *ngIf="!secondFormGroup.get('birthday').valid && !secondFormGroup.get('birthday').errors.required">
              Please enter a valid date<!--You must be over 16 years old-->
            </mat-error>
          </mat-form-field>
        </div>
        <br>
        <div fxLayout="row" fxLayout.xs="column">
          <mat-form-field>
            <input formControlName="location" matInput placeholder="Location" required>
            <mat-icon color="primary" matPrefix svgIcon="place"></mat-icon>
            <mat-error *ngIf="!secondFormGroup.get('location').valid ">
              This field is required
            </mat-error>
          </mat-form-field>
        </div>
        <br>
        <div fxLayout="row" fxLayout.xs="column">
          <mat-form-field>
            <mat-select formControlName="role" placeholder="Role" required>
              <mat-option *ngFor="let role of roles" [value]="role.value">
                {{role.viewValue}}
              </mat-option>
            </mat-select>
            <mat-icon color="primary" matPrefix svgIcon="work"></mat-icon>

            <mat-error *ngIf="!secondFormGroup.get('role').valid ">
              This field is required
            </mat-error>

          </mat-form-field>
        </div>
        <br>
        <div fxLayout="row" fxLayoutAlign="end">
          <button color="primary" mat-button matStepperPrevious>Back</button>
          <button color="accent" mat-button matStepperNext type="button" (click)="onSave();">Sign Up!</button>
        </div>
      </div>
    </form>
  </mat-step>
  <mat-step>
    <form [formGroup]="thirdFormGroup">
      <ng-template matStepLabel>Your're in!</ng-template>
      <div class="container"
           fxFlex="100%"
           fxFlex.gt-md="60%"
           fxFlexOffset="15%"
           fxFlexOffset.xs="0"
           fxLayout="column"
           fxLayoutAlign="center">
        <div fxLayout="column">
          <h2 fxLayoutAlign="center center">✨ Welcome to the Kwee family! ✨</h2>
          <p>Complete your profile to increase your visibility and help you find the job you want!</p>
        </div>
        <br>
        <div fxLayout="column">
          <h4>Bio</h4>
          <mat-form-field>
            <textarea formControlName="bio" matInput placeholder="Leave a comment"></textarea>
          </mat-form-field>
        </div>
        <br>
        <!--------------------------------------------------->
        <h4>Experience</h4>
        <div fxLayout="column" fxLayoutGap="16px">
          <div formArrayName="experience" fxLayout="column" fxLayoutGap="16px"
          *ngFor="let ex of this.formExperience.controls; let s =index;">
            <div fxFlex=80%; fxLayout="column" [formGroupName]="s">
            <mat-accordion id="{{'accordion'+s}}">
              <mat-expansion-panel expanded>
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    <span *ngIf="title.value; else titled">{{title.value}}</span>
                    <ng-template #titled><span>Title</span></ng-template>
                  </mat-panel-title>
                  <mat-panel-description fxHide fxShow.gt-xs>
                    <span *ngIf="(iend.value && !iend.disabled && istart.value) ||
                    (iend.disabled && istart.value)
                    ; else date">
                    From: {{istart.value}} to: 
                    <span *ngIf="iend.value && !iend.disabled">
                    {{iend.value}} </span>
                    <span *ngIf="current.checked">
                    current</span>
                  </span>

                    <ng-template #date><span>Date</span></ng-template>
                    
                    
                  </mat-panel-description>
                </mat-expansion-panel-header>


              <div fxLayout="column" fxLayout.xs="column" fxLayoutGap="16px" fxLayoutGap.xs="0">
                <mat-form-field >
                  <input 
                  #title
                  id="{{'titlex'+s}}"
                   placeholder="Title"
                   formControlName="title"
                   class="form-control"
                   matInput type="text">
                </mat-form-field>
              </div>
              <!--------------------------------------------------->
              <div fxLayout="column" fxLayout.xs="column" fxLayoutGap="16px" fxLayoutGap.xs="0">
                <mat-form-field>
                  <input 
                   placeholder="Company"
                   formControlName="company"
                   class="form-control"
                   matInput type="text">
                </mat-form-field>
              </div>
              <!--------------------------------------------------->
              <div fxLayout="row" 
              fxLayout.xs="column" 
              fxLayoutGap="16px" 
              fxLayoutGap.xs="0px"
              fxLayoutAlign.xs="center start">
              <mat-form-field fxFlex="30%">
                <input #istart [matDatepicker]="start" formControlName="start" matInput placeholder="Start" >
                <mat-datepicker-toggle [for]="start" matPrefix></mat-datepicker-toggle>
                <mat-datepicker #start ></mat-datepicker>
              </mat-form-field>
              
              <!--------------------------------------------------->
              <p> To: </p>
              <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="16px" >
              <mat-form-field fxFlex="50%" fxFlex.xs="70%">
                <input id="{{'toEx'+s}}" #iend [matDatepicker]="end" formControlName="end" matInput placeholder="End">
                <mat-datepicker-toggle [for]="end" matPrefix></mat-datepicker-toggle>
                <mat-datepicker #end 
                [disabled]="current.checked"
                ></mat-datepicker>
              </mat-form-field>
              
              <mat-checkbox #current (change)="onChange($event, s)">current</mat-checkbox>
              </div>
              </div>
              <!--------------------------------------------------->
              <div fxLayout="column" fxLayout.xs="column">
                <mat-form-field >
                  <textarea formControlName="description" matInput placeholder="Description"></textarea>
                </mat-form-field>
              </div>
              <div fxLayout="row"
                   fxLayoutAlign="end" fxLayoutGap="0"
                   fxLayoutGap.gt-sm="8px">
                <div >
                  <button (click)="deleteExperience(s)" color="warn" mat-button>Delete</button>
                </div>
                <div>
                  <button color="accent" mat-button>Done</button>
                </div>
                
              </div>
            </mat-expansion-panel></mat-accordion> 
            </div>        
          </div>
          <div class="divBtn" fxLayout="column" fxLayoutAlign="end">
            <button (click)=" addExperience()" mat-button type="button">
              Add
            </button>
          </div>
        </div>
        <br>
        <!--------------------------------------------------->
        <h4>Education</h4>
        <div fxLayout="column" fxLayoutGap="16px">
          <div formArrayName="education" fxLayout="column" fxLayoutGap="16px"
          *ngFor="let ed of this.formEducation.controls; let a =index;">
            <div fxFlex=80%; fxLayout="column" [formGroupName]="a">
            <mat-accordion id="{{'accordion'+a}}">
              <mat-expansion-panel expanded>
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    <span *ngIf="title.value; else titled">{{title.value}}</span>
                    <ng-template #titled><span>Title</span></ng-template>
                  </mat-panel-title>
                  <mat-panel-description fxHide fxShow.gt-xs>
                    <span *ngIf="(iend.value && !iend.disabled && istart.value) ||
                    (iend.disabled && istart.value)
                    ; else date">
                    From: {{istart.value}} to: 
                    <span *ngIf="iend.value && !iend.disabled">
                    {{iend.value}} </span>
                    <span *ngIf="current.checked">
                    current</span>
                  </span>

                    <ng-template #date><span>Date</span></ng-template>
                    
                    
                  </mat-panel-description>
                </mat-expansion-panel-header>


              <div fxLayout="column" fxLayout.xs="column" fxLayoutGap="16px" fxLayoutGap.xs="0">
                <mat-form-field >
                  <input 
                  #title
                  id="{{'titled'+a}}"
                   placeholder="Title"
                   formControlName="title"
                   class="form-control"
                   matInput type="text">
                </mat-form-field>
              </div>
              <!--------------------------------------------------->
              <div fxLayout="column" fxLayout.xs="column" fxLayoutGap="16px" fxLayoutGap.xs="0">
                <mat-form-field>
                  <input 
                   placeholder="Institution"
                   formControlName="institution"
                   class="form-control"
                   matInput type="text">
                </mat-form-field>
              </div>
              <!--------------------------------------------------->
              <div fxLayout="row" 
              fxLayout.xs="column" 
              fxLayoutGap="16px" 
              fxLayoutGap.xs="0px"
              fxLayoutAlign.xs="center start">
              <mat-form-field fxFlex="30%">
                <input #istart [matDatepicker]="start" formControlName="start" matInput placeholder="Start" >
                <mat-datepicker-toggle [for]="start" matPrefix></mat-datepicker-toggle>
                <mat-datepicker #start ></mat-datepicker>
              </mat-form-field>
              
              <!--------------------------------------------------->
              <p> To: </p>
              <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="16px" >
              <mat-form-field fxFlex="50%" fxFlex.xs="70%">
                <input id="{{'toEd'+a}}" #iend [matDatepicker]="end" formControlName="end" matInput placeholder="End">
                <mat-datepicker-toggle [for]="end" matPrefix></mat-datepicker-toggle>
                <mat-datepicker #end 
                [disabled]="current.checked"
                ></mat-datepicker>
              </mat-form-field>
              
              <mat-checkbox #current (change)="onChangeEd($event, a)">current</mat-checkbox>
              </div>
              </div>
              <!--------------------------------------------------->
              <div fxLayout="column" fxLayout.xs="column">
                <mat-form-field >
                  <textarea formControlName="description" matInput placeholder="Description"></textarea>
                </mat-form-field>
              </div>
              <div fxLayout="row"
                   fxLayoutAlign="end" fxLayoutGap="0"
                   fxLayoutGap.gt-sm="8px">
                <div >
                  <button (click)="deleteEducation(a)" color="warn" mat-button>Delete</button>
                </div>
                <div>
                  <button color="accent" mat-button>Done</button>
                </div>
                
              </div>
            </mat-expansion-panel></mat-accordion> 
            </div>        
          </div>
          <div class="divBtn" fxLayout="column" fxLayoutAlign="end">
            <button (click)=" addEducation()" mat-button type="button">
              Add
            </button>
          </div>
        </div>
        <br>
        <!--------------------------------------------------->
        <h4>Skills:</h4>
        <div fxLayout="row" fxLayoutGap="16px">
          <div formArrayName="skills" fxFlex="50%" fxLayout="column" fxLayoutGap="-16px">
            <mat-form-field *ngFor="let skill of formSkills.controls; let i =index;">
              <input (keyup.enter)='add_skill()'
                     [formControlName]="i"
                     class="form-control"
                     id="{{'skill'+i}}"
                     matInput type="text">


              <button (click)="deleteSkill(i)" *ngIf="this.formSkills.controls[i].value && this.formSkills.length-1!=i" aria-label="Clear"
                      mat-button mat-icon-button matSuffix type="button">
                <mat-icon>close</mat-icon>
              </button>

              <button (click)="deleteSkill(i); add_skill()" *ngIf="this.formSkills.controls[i].value && this.formSkills.length-1==i" aria-label="Clear"
                      mat-button mat-icon-button matSuffix type="button">
                <mat-icon>close</mat-icon>
              </button>
            </mat-form-field>
          </div>
          <div class="divBtn" fxLayout="column" fxLayoutAlign="end">
            <button (click)=" add_skill()" mat-button type="button">
              Add
            </button>
          </div>
        </div>
        <!----------------------------------------->
        <h4>Languages:</h4>
         <div fxLayout="column" fxLayoutGap="16px">
          <div formArrayName="languages" fxLayout="column" fxLayoutGap="16px"
          *ngFor="let language of formLanguages.controls; let j =index;">
            <div fxFlex=80%; fxLayout="column" [formGroupName]="j">
            <mat-accordion>
              <mat-expansion-panel expanded>
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    <span *ngIf="language.value; else l">{{language.value}}</span>
                    <ng-template #l><span>Language</span></ng-template>
                  </mat-panel-title>
                  <mat-panel-description fxHide fxShow.gt-xs>
                    <span *ngIf="proficiency.value; else p">{{getProf(proficiency.value)}}</span>
                    <ng-template #p><span>Proficiency</span></ng-template>
                  </mat-panel-description>
                </mat-expansion-panel-header>
              <div fxLayout="row" fxLayout.xs="column" fxLayoutGap="16px" fxLayoutGap.xs="0">
              <div fxLayout="row" fxLayout.xs="column" fxLayoutGap="16px" fxLayoutGap.xs="0">

               <mat-form-field>
              <input 
              #language
               placeholder="Language"
               formControlName="language"
               class="form-control"
               
               matInput type="text">
              </mat-form-field>
              </div>
              <div fxLayout="row" fxLayout.xs="column" fxLayoutGap="16px" fxLayoutGap.xs="0">
              <mat-form-field>
                <mat-select #proficiency formControlName="proficiency" placeholder="Proficiency">
                  <mat-option *ngFor="let proficiency of proficiencies" [value]="proficiency.value">
                    {{proficiency.viewValue}}
                  </mat-option>
                </mat-select>
                
              </mat-form-field>
            </div></div>
              <!--------------------------------------------------->
              <div fxLayout="row"
                   fxLayoutAlign="end" fxLayoutGap="0"
                   fxLayoutGap.gt-sm="8px">
                <div >
                  <button (click)="deleteLanguage(s)" color="warn" mat-button>Delete</button>
                </div>
                <div>
                  <button color="accent" mat-button>Done</button>
                </div>
                
              </div>
            </mat-expansion-panel></mat-accordion> 
            </div>        
          </div>
          <div class="divBtn" fxLayout="column" fxLayoutAlign="end">
            <button (click)=" addLanguage()" mat-button type="button">
              Add
            </button>
          </div>
        </div>
        <!----------------------------------------->
        <div fxLayout="row" fxLayoutAlign="end">
          <button color="accent" mat-button routerLink="/" type="button">Done</button>
        </div>
      </div>
    </form>
  </mat-step>
</mat-horizontal-stepper>
